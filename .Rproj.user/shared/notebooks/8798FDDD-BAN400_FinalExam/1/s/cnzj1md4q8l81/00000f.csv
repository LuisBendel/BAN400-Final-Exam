"0","is_variable_significant_cpp <- function(covariates, response, variable_to_assess, data = bacedata) {"
"0","  # create model as string"
"0","  model_call <- paste0("
"0","    response, "" ~ "","
"0","    paste0(covariates, collapse = "" + ""), "" + "","
"0","    variable_to_assess"
"0","  )"
"0",""
"0","  # all explantory variables, including variable of interest"
"0","  # must be filtered to != """" because one model contains only var of interes"
"0","  explanatory_var <- c(covariates, variable_to_assess)"
"0","  explanatory_var <- explanatory_var[explanatory_var != """"]"
"0",""
"0","  # all variables, including response variable"
"0","  all_var <- c(response, explanatory_var)"
"0",""
"0","  # data must be filtered: fastLmPure cannot handle NAs"
"0","  data_filtered <- na.omit(data[all_var])"
"0",""
"0","  # define input parameters for fastLmPure"
"0","  # matrix of all explanatory values and vector of response values"
"0","  X <- as.matrix(cbind(1, data_filtered[explanatory_var]))"
"0","  y <- as.vector(data_filtered[[response]])"
"0",""
"0","  # Fit the model using fastLmPure and input parameters defined above"
"0","  model_est <- RcppArmadillo::fastLmPure(y = y, X = X)"
"0",""
"0","  # Calculate index for the coefficient"
"0","  # +2, because one intercept, and the last one is the var of interest"
"0","  index <- (ifelse(any(covariates == """"), 0, length(covariates)) + 2)"
"0",""
"0","  # Extract coefficient and standard error needed to compute t statistic"
"0","  coefficient_estimate <- model_est$coefficients[index, ]"
"0","  coefficient_stderr <- model_est$stderr[index, ]"
"0",""
"0","  # calculate degrees of freedom (n - k - 1) with k exlanatories and n observations"
"0","  degrees_of_freedom <- length(y) - length(explanatory_var) - 1"
"0",""
"0","  # Calculate p-value of two-sided t-test"
"0","  coefficient_pvalue <- 2 * pt(abs(coefficient_estimate / coefficient_stderr),"
"0","    degrees_of_freedom,"
"0","    lower.tail = FALSE"
"0","  )"
"0",""
"0","  # return data frame of results"
"0","  tibble("
"0","    model_call = model_call,"
"0","    assessed_variable = variable_to_assess,"
"0","    coefficient_estimate = coefficient_estimate,"
"0","    p_value = coefficient_pvalue,"
"0","    stderr = coefficient_stderr"
"0","  )"
"0","}"
"0",""
"0","# start timer"
"0","tic()"
"0",""
"0","# add a column with estimated models using function from A3 to explanatory_combs df"
"0","explanatory_combs$model_A5 <- map(explanatory_combs$explanatory_comb,"
"0","  is_variable_significant_cpp,"
"0","  response = ""GR6096"","
"0","  variable_to_assess = ""SOCIALIST"","
"0","  data = bacedata"
"0",")"
"0",""
"0","# report elapsed time"
"0","toc()"
"1","1.77 sec elapsed
"
