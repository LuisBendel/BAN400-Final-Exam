"0","# generate all possible subsets of this vector"
"0","# do not forget the possibility to use only SOCIALIST, without controls"
"0","explanatory_combs <- lapply(1:length(explanatory_var),"
"0","  combinat::combn,"
"0","  x = explanatory_var,"
"0","  simplify = F"
"0",") %>%"
"0","  unlist(., recursive = F) %>%"
"0","  as.matrix() %>%"
"0","  as_tibble(.name_repair = ""unique"") %>%"
"0","  rename(explanatory_comb = ...1) %>%"
"0","  rbind("""")"
"2","New names:"
"0","# now estimate the model for every combination generated above"
"0","# I separate this from the pipe above for documentation purposes"
"0","explanatory_combs$model_A2 <- map(explanatory_combs$explanatory_comb,"
"0","  reg_fraud,"
"0","  df = bacedata"
"0",")"
"0",""
"0","# function to extract the coefficient on SOCIALIST in each model"
"0","get_coef_SOCIALIST <- function(model) {"
"0","  model[1]$coefficients[names(model[1]$coefficients) == ""SOCIALIST""]"
"0","}"
"0",""
"0","# plot coefficients on SOCIALIST for all models"
"0","coef_hist <- explanatory_combs %>%"
"0","  mutate(coef_SOCIALIST = map_dbl(model_A2, get_coef_SOCIALIST)) %>%"
"0","  ggplot(aes(x = coef_SOCIALIST)) +"
"0","  geom_histogram(bins = 50) +"
"0","  geom_vline("
"0","    xintercept = median(map_dbl(explanatory_combs$model_A2, get_coef_SOCIALIST)),"
"0","    color = ""red"","
"0","    linewidth = 1.5"
"0","  ) +"
"0","  annotate("
"0","    ""text"","
"0","    x = -0.009, y = 60,"
"0","    label = paste0(""median ~ "", round(median(map_dbl(explanatory_combs$model_A2, get_coef_SOCIALIST)), 6)),"
"0","    vjust = 1.1, hjust = 3, color = ""red"", size = 6"
"0","  ) +"
"0","  labs("
"0","    title = ""Distribution of coefficient on SOCIALIST"","
"0","    x = ""Coefficient on SOCIALIST"""
"0","  ) +"
"0","  theme_minimal()"
"0",""
"0","ggplotly(coef_hist)"
