"0","# using dplyr instead of base R to reshape the data to fit the"
"0","# input-parameters needed for fastLmPure funtion"
"0","is_variable_significant_cpp_dplyr <- function(covariates, response, variable_to_assess, data = bacedata) {"
"0","  # create model as string"
"0","  model_call <- paste0("
"0","    response, "" ~ "","
"0","    paste0(covariates, collapse = "" + ""), "" + "","
"0","    variable_to_assess"
"0","  )"
"0",""
"0","  # for fastLmPure to estimate using c++, we need to reshape the input"
"0","  # fastLmPure cannot handle NAs"
"0","  data_filtered <- data %>%"
"0","    select(all_of(response), which(names(data) %in% covariates), all_of(variable_to_assess)) %>%"
"0","    filter(complete.cases(.))"
"0",""
"0","  # fastLmPure needs matrix input for explanatories"
"0","  X <- cbind(1, as.matrix(data_filtered %>% select(-all_of(response))))"
"0",""
"0","  # y must be single atomic vector containing all values for response variable"
"0","  y <- data_filtered %>% pull(response)"
"0",""
"0","  # now, using X and y, we can estimate model with fastLmPure"
"0","  model_est <- RcppArmadillo::fastLmPure(y = y, X = X)"
"0",""
"0","  # index to extract coefficient etc."
"0","  index <- ifelse(any(covariates == """"), 0, length(covariates)) + 2"
"0",""
"0","  # extract the coefficient estimate from the model"
"0","  coefficient_estimate <- model_est$coefficients[index, ]"
"0",""
"0","  # calculate the p-value from the variable to assess"
"0","  coefficient_pvalue <- 2 * pt("
"0","    abs(model_est$coefficients[index, ] / model_est$stderr[index, ]),"
"0","    model_est$df.residual,"
"0","    lower.tail = FALSE"
"0","  )"
"0",""
"0","  # return data frame of results"
"0","  tibble("
"0","    model_call = model_call,"
"0","    assessed_variable = variable_to_assess,"
"0","    coefficient_estimate = coefficient_estimate,"
"0","    p_value = coefficient_pvalue"
"0","  )"
"0","}"
"0",""
"0",""
"0","# start timer"
"0","tic()"
"0",""
"0","# add a column with estimated models using function from A3 to explanatory_combs df"
"0","explanatory_combs$model_A5 <- map(explanatory_combs$explanatory_comb,"
"0","  is_variable_significant_cpp_dplyr,"
"0","  response = ""GR6096"","
"0","  variable_to_assess = ""SOCIALIST"","
"0","  data = bacedata"
"0",")"
"0",""
"0","# report elapsed time"
"0","toc()"
"1","6.06 sec elapsed
"
